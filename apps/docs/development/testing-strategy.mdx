---
title: Testing Strategy
description: Comprehensive testing approach for LiqUIdify components including unit, integration, accessibility, and performance testing.
---

# Testing Strategy

LiqUIdify employs a comprehensive testing strategy to ensure component quality, accessibility, and performance. This guide explains our testing approach, tools, and best practices.

## ðŸŽ¯ Testing Philosophy

### Core Principles

1. **Test User Behavior**: Focus on how users interact with components
2. **Accessibility First**: Every component must be WCAG 2.1 AA compliant
3. **Fast Feedback**: Tests should run quickly for rapid development
4. **Comprehensive Coverage**: Unit, integration, accessibility, and E2E tests
5. **Visual Regression**: Catch unintended UI changes

### Testing Pyramid

```
         /\
        /E2E\
       /------\
      /Visual  \
     /----------\
    /Integration \
   /--------------\
  / Accessibility  \
 /------------------\
/    Unit Tests      \
```

## ðŸ› ï¸ Testing Stack

### Core Tools

- **Vitest**: Fast unit test runner with native ESM support
- **Testing Library**: User-centric testing utilities
- **Playwright**: E2E and cross-browser testing
- **Axe-core**: Automated accessibility testing
- **Storybook**: Visual testing and component playground
- **Happy DOM**: Fast DOM implementation for tests

### Configuration

```js
// vitest.config.ts
import { defineConfig } from "vitest/config";
import react from "@vitejs/plugin-react";

export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: "happy-dom",
    setupFiles: ["./src/test/setup.ts"],
    coverage: {
      provider: "v8",
      reporter: ["text", "json", "html"],
      exclude: ["node_modules", "test", "*.config.ts"],
    },
  },
});
```

## ðŸ§ª Unit Testing

### Component Testing Pattern

```js
// glass-button.test.tsx
import { render, screen, fireEvent } from "@testing-library/react";
import { vi } from "vitest";
import { GlassButton } from "./glass-button";

describe("GlassButton", () => {
  it("renders children correctly", () => {
    render(<GlassButton>Click me</GlassButton>);
    expect(screen.getByRole("button")).toHaveTextContent("Click me");
  });

  it("handles click events", () => {
    const handleClick = vi.fn();
    render(<GlassButton onClick={handleClick}>Click</GlassButton>);

    fireEvent.click(screen.getByRole("button"));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it("respects disabled state", () => {
    const handleClick = vi.fn();
    render(
      <GlassButton disabled onClick={handleClick}>
        Disabled
      </GlassButton>,
    );

    const button = screen.getByRole("button");
    expect(button).toBeDisabled();

    fireEvent.click(button);
    expect(handleClick).not.toHaveBeenCalled();
  });

  it("applies variant styles", () => {
    const { rerender } = render(
      <GlassButton variant="primary">Primary</GlassButton>,
    );
    expect(screen.getByRole("button")).toHaveClass("glass-button--primary");

    rerender(<GlassButton variant="secondary">Secondary</GlassButton>);
    expect(screen.getByRole("button")).toHaveClass("glass-button--secondary");
  });
});
```

### Hook Testing Pattern

```js
// useTheme.test.tsx
import { renderHook, act } from "@testing-library/react";
import { ThemeProvider, useTheme } from "./theme";

describe("useTheme", () => {
  it("provides theme context", () => {
    const wrapper = ({ children }) => (
      <ThemeProvider theme="light">{children}</ThemeProvider>
    );

    const { result } = renderHook(() => useTheme(), { wrapper });

    expect(result.current.theme).toBe("light");
  });

  it("allows theme changes", () => {
    const wrapper = ({ children }) => <ThemeProvider>{children}</ThemeProvider>;

    const { result } = renderHook(() => useTheme(), { wrapper });

    act(() => {
      result.current.setTheme("dark");
    });

    expect(result.current.theme).toBe("dark");
  });
});
```

## â™¿ Accessibility Testing

### Automated A11y Tests

```js
// glass-button.a11y.test.tsx
import { render } from "@testing-library/react";
import { axe, toHaveNoViolations } from "jest-axe";
import { GlassButton } from "./glass-button";

expect.extend(toHaveNoViolations);

describe("GlassButton Accessibility", () => {
  it("meets WCAG standards", async () => {
    const { container } = render(<GlassButton>Accessible Button</GlassButton>);

    const results = await axe(container);
    expect(results).toHaveNoViolations();
  });

  it("has proper ARIA attributes", () => {
    const { getByRole } = render(
      <GlassButton aria-label="Save document" loading>
        Save
      </GlassButton>,
    );

    const button = getByRole("button");
    expect(button).toHaveAttribute("aria-label", "Save document");
    expect(button).toHaveAttribute("aria-busy", "true");
  });

  it("supports keyboard navigation", () => {
    const handleClick = vi.fn();
    const { getByRole } = render(
      <GlassButton onClick={handleClick}>Keyboard</GlassButton>,
    );

    const button = getByRole("button");
    button.focus();
    expect(document.activeElement).toBe(button);

    fireEvent.keyDown(button, { key: "Enter" });
    expect(handleClick).toHaveBeenCalled();
  });
});
```

### Manual A11y Checklist

```markdown
## Component Accessibility Checklist

- [ ] Keyboard Navigation
  - [ ] Tab order is logical
  - [ ] Focus indicators are visible
  - [ ] All interactive elements are reachable
- [ ] Screen Reader Support
  - [ ] Proper ARIA labels
  - [ ] Role attributes are correct
  - [ ] State changes are announced
- [ ] Color Contrast
  - [ ] Text meets 4.5:1 ratio
  - [ ] Large text meets 3:1 ratio
  - [ ] Focus indicators meet 3:1 ratio
- [ ] Motion and Animation
  - [ ] Respects prefers-reduced-motion
  - [ ] Animations can be paused
  - [ ] No seizure-inducing patterns
```

## ðŸ”„ Integration Testing

### Component Integration Tests

```js
// form-integration.test.tsx
import { render, screen, waitFor } from "@testing-library/react";
import userEvent from "@testing-library/user-event";
import { LoginForm } from "./LoginForm";

describe("LoginForm Integration", () => {
  it("submits form with valid data", async () => {
    const user = userEvent.setup();
    const handleSubmit = vi.fn();

    render(<LoginForm onSubmit={handleSubmit} />);

    // Fill form
    await user.type(screen.getByLabelText("Email"), "user@example.com");
    await user.type(screen.getByLabelText("Password"), "password123");

    // Submit
    await user.click(screen.getByRole("button", { name: "Login" }));

    await waitFor(() => {
      expect(handleSubmit).toHaveBeenCalledWith({
        email: "user@example.com",
        password: "password123",
      });
    });
  });

  it("shows validation errors", async () => {
    const user = userEvent.setup();

    render(<LoginForm />);

    // Submit empty form
    await user.click(screen.getByRole("button", { name: "Login" }));

    expect(await screen.findByText("Email is required")).toBeInTheDocument();
    expect(await screen.findByText("Password is required")).toBeInTheDocument();
  });
});
```

## ðŸŽ­ E2E Testing

### Playwright Configuration

```js
// playwright.config.ts
import { defineConfig, devices } from "@playwright/test";

export default defineConfig({
  testDir: "./e2e",
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  reporter: "html",
  use: {
    baseURL: "http://localhost:3000",
    trace: "on-first-retry",
  },
  projects: [
    { name: "chromium", use: { ...devices["Desktop Chrome"] } },
    { name: "firefox", use: { ...devices["Desktop Firefox"] } },
    { name: "webkit", use: { ...devices["Desktop Safari"] } },
    { name: "mobile", use: { ...devices["iPhone 13"] } },
  ],
});
```

### E2E Test Example

```js
// e2e/dashboard.spec.ts
import { test, expect } from "@playwright/test";

test.describe("Dashboard", () => {
  test.beforeEach(async ({ page }) => {
    await page.goto("/dashboard");
  });

  test("displays user data", async ({ page }) => {
    await expect(page.locator("h1")).toContainText("Dashboard");
    await expect(page.locator('[data-testid="user-name"]')).toBeVisible();
  });

  test("navigates to settings", async ({ page }) => {
    await page.click('button:has-text("Settings")');
    await expect(page).toHaveURL("/settings");
  });

  test("modal interaction", async ({ page }) => {
    await page.click('button:has-text("Add Item")');

    const modal = page.locator('[role="dialog"]');
    await expect(modal).toBeVisible();

    await page.fill('[name="title"]', "New Item");
    await page.click('button:has-text("Save")');

    await expect(modal).not.toBeVisible();
    await expect(page.locator("text=New Item")).toBeVisible();
  });
});
```

## ðŸ“¸ Visual Regression Testing

### Storybook Visual Tests

```js
// glass-button.stories.tsx
import { GlassButton } from "./glass-button";

const meta = {
  title: "Components/GlassButton",
  component: GlassButton,
  parameters: {
    chromatic: { viewports: [320, 1200] },
  },
};

export default meta;

export const AllVariants = {
  render: () => {
    return React.createElement(
      "div",
      { className: "space-y-4" },
      React.createElement(GlassButton, { variant: "primary" }, "Primary"),
      React.createElement(GlassButton, { variant: "secondary" }, "Secondary"),
      React.createElement(GlassButton, { variant: "ghost" }, "Ghost"),
      React.createElement(GlassButton, { disabled: true }, "Disabled"),
      React.createElement(GlassButton, { loading: true }, "Loading"),
    );
  },
};
```

### Visual Test Automation

```bash
# Run visual tests
npm run chromatic

# Review changes
npm run chromatic -- --auto-accept-changes
```

## ðŸš€ Performance Testing

### Bundle Size Testing

```js
// test/bundle-size.test.ts
import { readFileSync } from "fs";
import { gzipSync } from "zlib";

describe("Bundle Size", () => {
  it("stays within size budget", () => {
    const bundle = readFileSync("dist/index.mjs");
    const gzipped = gzipSync(bundle);

    expect(gzipped.length).toBeLessThan(30 * 1024); // 30KB
  });
});
```

### Runtime Performance Tests

```js
// performance.test.tsx
import { render } from "@testing-library/react";
import { measurePerformance } from "./test-utils";

describe("Performance", () => {
  it("renders quickly", async () => {
    const largeDataset = []; // Mock data
    const { duration } = await measurePerformance(() => {
      render(React.createElement(ComplexComponent, { data: largeDataset }));
    });

    expect(duration).toBeLessThan(100); // 100ms
  });

  it("updates efficiently", async () => {
    const { rerender } = render(
      React.createElement(Component, { prop: "initial" }),
    );

    const { duration } = await measurePerformance(() => {
      rerender(React.createElement(Component, { prop: "updated" }));
    });

    expect(duration).toBeLessThan(16); // 60fps
  });
});
```

## ðŸ“ Test Coverage

### Coverage Requirements

- **Overall**: >= 80%
- **Components**: >= 90%
- **Hooks**: >= 95%
- **Utils**: >= 100%

### Coverage Commands

```bash
# Run tests with coverage
bun run test:coverage

# Generate HTML report
bun run test:coverage --reporter=html

# Check coverage thresholds
bun run test:coverage --coverage.thresholdAutoUpdate
```

### Coverage Configuration

```js
// vitest.config.ts coverage configuration
export default defineConfig({
  test: {
    coverage: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80,
      exclude: ["**/*.stories.tsx", "**/*.test.tsx", "**/test/**"],
    },
  },
});
```

## ðŸ”„ Continuous Integration

### CI Test Pipeline

```yaml
# .github/workflows/test.yml
name: Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: oven-sh/setup-bun@v1

      - name: Install
        run: bun install

      - name: Unit Tests
        run: bun run test

      - name: A11y Tests
        run: bun run test:a11y

      - name: Coverage
        run: bun run test:coverage

      - name: Upload Coverage
        uses: codecov/codecov-action@v3

  e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: oven-sh/setup-bun@v1

      - name: Install
        run: bun install

      - name: Install Playwright
        run: bunx playwright install

      - name: E2E Tests
        run: bun run test:e2e

      - name: Upload Results
        uses: actions/upload-artifact@v3
        with:
          name: playwright-report
          path: playwright-report/
```

## ðŸŽ¯ Best Practices

### Testing Guidelines

1. **Test Behavior, Not Implementation**

   ```text
   // âœ… Good
   expect(screen.getByRole("button")).toBeDisabled();

   // âŒ Bad
   expect(button.props.disabled).toBe(true);
   ```

2. **Use Testing Library Queries**

   ```text
   // âœ… Good
   screen.getByRole("button", { name: "Submit" });

   // âŒ Bad
   container.querySelector(".submit-button");
   ```

3. **Avoid Testing Library Details**

   ```text
   // âœ… Good
   expect(screen.getByText("Loading...")).toBeInTheDocument();

   // âŒ Bad
   expect(component.state.isLoading).toBe(true);
   ```

4. **Test Error States**

   ```text
   it("handles errors gracefully", async () => {
     server.use(
       rest.get("/api/data", (req, res, ctx) => {
         return res(ctx.status(500));
       }),
     );

     render(<Component />);

     expect(await screen.findByText("Error loading data")).toBeInTheDocument();
   });
   ```

## ðŸ› Debugging Tests

### Debug Utilities

```text
// Debug component rendering
import { render, screen } from "@testing-library/react";

test("debugging example", () => {
  const { debug } = render(<Component />);
  debug(); // Prints DOM
  debug(screen.getByRole("button")); // Prints specific element
});

// Visual debugging in headed mode (Playwright)
test("visual debug", async ({ page }) => {
  await page.pause(); // Pauses execution for debugging
});
```

### Common Issues

**Issue**: Async state updates

```text
// Solution: Use waitFor
await waitFor(() => {
  expect(screen.getByText("Updated")).toBeInTheDocument();
});
```

**Issue**: Timer-based code

```text
// Solution: Use fake timers
vi.useFakeTimers();
act(() => {
  vi.advanceTimersByTime(1000);
});
vi.useRealTimers();
```

**Issue**: External dependencies

```text
// Solution: Mock modules
vi.mock("external-lib", () => ({
  default: vi.fn(),
}));
```

## ðŸ“š Related Documentation

- [Architecture](./architecture): Component structure
- [Developer Onboarding](./onboarding): Getting started with testing
- [Contributing](/contributing): Test requirements for PRs
- [Accessibility Guide](/guides/accessibility): A11y testing details
